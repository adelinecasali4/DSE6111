---
title: "Week Four Exercises"
author: "Adeline Casali"
date: "2023-11-15"
output: word_document
---

# Question 6
Load packages and Data
```{r}
library(ISLR2)
library(boot)
Default <- read.csv("Week_Four/Default.csv")
```

a) Using glm() standard error for income was estimated to be 1.274e-07 and the standard error for balance was estimated to be 3.514e-06. 
```{r}
set.seed(123)
Default$default <- ifelse(Default$default == "Yes", 1, 0)
default_lmodel <- glm(default ~ income + balance, data = Default)
summary(default_lmodel)
```
b) Here is a function that will output the coefficient estimates for income and balance from the logistic regression model. 
```{r}
boot.fn <- function(data, index) {
  coef(glm(default ~ income + balance, data = data, subset = index))
}
```
c) Using boot() gives an estimated standard error of 1.297e-07 for income and 6.606e-06 for balance. 
```{r}
set.seed(123)
boot(Default, boot.fn, 1000)
```
d) The estimated standard errors obtained using both the glm() function and the bootstrap method were incredibly similar. Although they do differ slightly, they are so small and so close that it doesn't actually make a difference. 
```{r}
glm_std_errors <- c(1.274e-07, 3.514e-06)
boot_std_errors <- c(1.297e-07, 6.606e-06)
std_err_compare <- data.frame(
  Method = c("glm()", "boot()"),
  Std_Error = c(glm_std_errors, boot_std_errors),
  Variable = rep(c("Income", "Balance"), each = 2)
)
print(std_err_compare)
```


# Question 9
a) An estimate of the population mean of median value of owner occupied homes in 1000s. 
```{r}
mu_hat <- mean(Boston$medv)
print(mu_hat)
```
b) The standard error represents the typical amount of variability we might expect in the sample mean if we were to take multiple random samples from the population. In this case, the estimate of 0.4088611 indicates the standard deviation of the distribution of sample means.
```{r}
se_mu_hat <- sd(Boston$medv) / sqrt(length(Boston$medv))
print(se_mu_hat)
```
c) The standard error generated by the bootstrap methos is 0.4045557, which is extremely close to the standard error calculated in (b) of 0.4088611. 
```{r}
mean.fn <- function(data, index) {
  sample_data <- data$medv[index]
  return(mean(sample_data))
}
set.seed(123)
boot(Boston, mean.fn, R = 1000)
```
d) The 95% confidence interval calculated from the bootstrap estimate of SE results a range of 21.72369 to 23.34192. The range obtained from the t-test is 21.72953 to 23.33608. These intervals are extremely close, differing by less than a hundredth on either side. 
```{r}
bs_se_mu_hat <- 0.4045557
ci <- c(mu_hat - 2 * bs_se_mu_hat, mu_hat + 2 * bs_se_mu_hat)
print(ci)

t.test(Boston$medv)
```
e) An estimate of the population median of the median value of owner occupied homes in 1000s. 
```{r}
mu_hat_med <- median(Boston$medv)
print(mu_hat_med)
```
f) The standard error of the median was estimated to be 0.3676453 by the bootstrap method. 
```{r}
median.fn <- function(data, index) {
  sample_data <- data$medv[index]
  return(median(sample_data))
}
set.seed(123)
boot(Boston, median.fn, R = 1000)
```
g) An estimate of the population tenth percentile of the median value of owner occupied homes in 1000s. 
```{r}
mu_hat_0.1 <- quantile(Boston$medv, 0.1)
mu_hat_0.1
```
h) The standard error of the tenth percentile was estimated to be 0.527868 by the bootstrap method. 
```{r}
tenth.fn <- function(data, index) {
  sample_data <- data$medv[index]
  return(quantile(sample_data, 0.1))
}
set.seed(123)
boot(Boston, tenth.fn, R = 1000)
```

